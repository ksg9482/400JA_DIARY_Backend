# 400JA_DIARY

## 기획
하루 400자, 가볍게 일기를 쓰는 웹 어플리케이션입니다.   
다양한 일기 웹/ 앱이 있지만 있는걸 그냥 사용하는 것 보다는 직접 만들어 보면서 필요한 기능을 구현하자는 생각에 기획하게 되었습니다.
처음에는 단순한 기능만 넣어서 개발할 생각이며 이는 새로운 기술 스택이 여러개 추가되는데 괜히 처음부터 대규모로 만들면 오류만 커진다고 판단했기 때문입니다.

___

## 백엔드
* 단어를 기준으로 한 일기 검색기능을 구현
  * mongoDB의 전문검색 기능을 위한 text index 설정
* 메일을 통한 유저인증 구현
  * 메일건(Mailgun)을 통해 이메일 전송
  * 인증 코드 만료를 구현하기 위해 TTL index 설정
* 보안 및 로그인 유지를 위해 JWT(Json Web Token) 설정 
* Google과 Kakao 소셜 로그인 구현
* Swagger를 이용한 API 명세서 작성

### 기술 스택
* Node.Js, Express
* mongoDB(mongoose)
* Nginx
* Docker
* Jest
* Swagger

___

## 디렉토리 구성
* 모델
  * User - 유저 등록 정보, 소셜로그인 여부 구분
  * Diary - 일기 정보, 전문 검색용 인덱스 설정(Text Index)
  * Mail - 유저 본인 인증용 보안 코드 저장. 3분 기한으로 자동 삭제(TTL Index)
* 컨트롤러
  * Auth - 비 로그인 API 전반
  * Diary - 일기 생성, 검색, 출력 API
  * User - 유저 생성, 검색, 출력 API
* 서비스
  * Auth - 로그인 및 회원가입, 소셜 로그인
  * Diary - 일기 생성 및 출력, 일기 검색
  * User - 유저 검색, 유저 정보 출력
  * Mail - 유저 메일 인증, 보안코드 확인
  * Util - 공통으로 사용되는 기능
* 미들웨어
  * attachCurrentUser - 로그인한 유저의 요청에서 JWT를 유저정보로 전환하여 전달
___

### 도커 컴포즈
sudo user=root pass=pass env=.env docker-compose up -d

### 소프트웨어 구조
소프트웨어 구조는 아래 링크를 참조해서 구현했습니다. 개발을 완료한 후에도 공부한 내용을 지속적으로 적용해 리팩토링할 예정이기 때문에 최대한 잘 구성된 견본을 따르려는 의도입니다. 

[견고한 node.js 프로젝트 설계하기](https://velog.io/@hopsprings2/%EA%B2%AC%EA%B3%A0%ED%95%9C-node.js-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EC%95%84%ED%82%A4%ED%85%8D%EC%B3%90-%EC%84%A4%EA%B3%84%ED%95%98%EA%B8%B0)

___

#### 개선점
* postman으로만 검사하고 E2E 테스트를 작성하지 않았다.
* 객체지향도 함수형 프로그래밍도 제대로 적용하지 못해서 두 패러다임이 제공하는 강점이 제대로 발휘되지 않았다.
* 백엔드에 신경쓴 나머지 프론트엔드는 저번 프론트엔드 구현과 비교하면 크게 개선되지 않았다.

#### 후기
좋았던 점과 아쉬웠던 점을 하나씩 꼽자면, 좋았던 점은 프론트엔드와 백엔드를 혼자서 만들어보니 프론트엔드가 백엔드에 바라는 점과 백엔드가 프론트엔드에 바라는 점을 제대로 느낄 수 있었다는 점입니다.

가령 무한스크롤을 구현할 때 프론트엔드에서 현재 가지고 있는 컨텐츠 이후의 데이터를 요청할 뿐이지만, 백엔드에서 데이터를 전할 때 데이터만 전달하는지 아니면 그 데이터가 마지막인지 여부 또한 전해주는지에 따라 기능을 얼마나 수월하게 개발할 수 있는지 달랐습니다.

아쉬웠던 점은 완성된 구조가 제대로된 객체지향의 모습도, 제대로된 함수형 프로그래밍도 아니라 어중간한 모습이라는 점입니다. 

개발 중간에 정말 개발자가 내게 맞는가 하는 흔들림이 있어서 정신 추스리는데 시간이 걸렸습니다. 신기한건 흔들림을 극복하니 프로젝트 초기보다 더한 열정이 생겨났습니다. 아직 제대로 하지도 않았는데 슬럼프에 빠지다니 지금 생각하면 우습기도 합니다. 정말이지 제겐 성장통과 같은 프로젝트 였습니다.
